# ü§ñ –ü–û–õ–ù–´–ô –ë–≠–ö–ê–ü –†–ê–ë–û–ß–ï–ì–û –ë–û–¢–ê

## ‚úÖ –í–°–ï –†–ê–ë–û–ß–ò–ï –§–£–ù–ö–¶–ò–ò –°–û–•–†–ê–ù–ï–ù–´

### üîß –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò
- ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Stripe** - –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–∫—É–ø–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
- ‚úÖ **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ–∫—É–ø–æ–∫** - –ø–æ customer_id + –¥–∞—Ç–∞
- ‚úÖ **–°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ** - –µ—Å–ª–∏ –æ–¥–∏–Ω –∫–ª–∏–µ–Ω—Ç –∫—É–ø–∏–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –¥–µ–Ω—å
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** - –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–∫—É–ø–∫–∏
- ‚úÖ **Google Sheets** - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - —Å –ø–æ–ª–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º
- ‚úÖ **Slack —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - —Å –ø–æ–ª–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º

### üìä –§–û–†–ú–ê–¢ –î–ê–ù–ù–´–• –í GOOGLE SHEETS
```
Purchase ID | Total Amount | Currency | Status | Created UTC | Created Local (UTC+1) | Customer ID | Customer Email | GEO | UTM Source | UTM Medium | UTM Campaign | UTM Content | UTM Term | Ad Name | Adset Name | Payment Count
```

### üì± –§–û–†–ú–ê–¢ TELEGRAM –£–í–ï–î–û–ú–õ–ï–ù–ò–ô
```
üü¢ Order [purchase_id] was processed!
---------------------------
üí≥ card
üí∞ [amount] [currency]
üè∑Ô∏è [payment_count]
---------------------------
üìß [email]
---------------------------
üå™Ô∏è [purchase_id]
üìç [country]
üîó quiz.testora.pro/iq1
meta
[platform_placement]
[ad_name]
[adset_name]
[campaign_name]
```

### üåç GEO –§–û–†–ú–ê–¢
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:** `Country, City` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `FR, Perpignan`)
- ‚úÖ **–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö:** Stripe API + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- ‚úÖ **Fallback:** –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚è∞ UTC+1 –í–†–ï–ú–Ø
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç:** UTC + 1 —á–∞—Å
- ‚úÖ **–§–æ—Ä–º–∞—Ç:** `2025-10-02 22:57:27 UTC+1`
- ‚úÖ **–ö–æ–ª–æ–Ω–∫–∞:** `Created Local (UTC+1)`

### üîÑ –õ–û–ì–ò–ö–ê –î–£–ë–õ–ò–ö–ê–¢–û–í
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ:** `purchase_id`
- ‚úÖ **–ö–æ–ª–æ–Ω–∫–∏:** `Purchase ID` –∏–ª–∏ `purchase_id`
- ‚úÖ **–õ–æ–≥–∏–∫–∞:** `rows.some((row) => row.get('Purchase ID') === purchaseId || row.get('purchase_id') === purchaseId)`

### üìà –ì–†–£–ü–ü–ò–†–û–í–ö–ê –ü–û–ö–£–ü–û–ö
- ‚úÖ **–ö–ª—é—á –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏:** `customer_id + date`
- ‚úÖ **–°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ:** `totalAmount += payment.amount`
- ‚úÖ **–°—á–µ—Ç—á–∏–∫:** `payment_count = group.payments.length`
- ‚úÖ **ID –ø–æ–∫—É–ø–∫–∏:** `purchase_${customerId}_${date}`

### üîß –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–£–©–ï–°–¢–í–£–Æ–©–ò–• –ó–ê–ü–ò–°–ï–ô
- ‚úÖ **UTC+1 –≤—Ä–µ–º—è** - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
- ‚úÖ **GEO –¥–∞–Ω–Ω—ã–µ** - –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
- ‚úÖ **–§–æ—Ä–º–∞—Ç:** `Country, City`

### üöÄ –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø
- ‚úÖ **–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- ‚úÖ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
- ‚úÖ **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫:** —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞

### üõ†Ô∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò
- ‚úÖ **Stripe API:** `paymentIntents.list` –∑–∞ 7 –¥–Ω–µ–π
- ‚úÖ **Google Sheets:** `google-spreadsheet` + JWT auth
- ‚úÖ **Telegram:** Bot API
- ‚úÖ **Slack:** Web API
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** try-catch –≤–µ–∑–¥–µ
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ø–æ–¥—Ä–æ–±–Ω—ã–µ console.log

### üìã –ü–ï–†–ï–ú–ï–ù–ù–´–ï –û–ö–†–£–ñ–ï–ù–ò–Ø
```
STRIPE_SECRET_KEY
TELEGRAM_BOT_TOKEN
TELEGRAM_CHAT_ID
SLACK_BOT_TOKEN
SLACK_CHANNEL_ID
GOOGLE_SERVICE_EMAIL
GOOGLE_SERVICE_PRIVATE_KEY
GOOGLE_SHEETS_DOC_ID
```

### üéØ –†–ï–ó–£–õ–¨–¢–ê–¢
–ë–æ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π:
- üîç –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Stripe –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- üìä –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏ –≤ Google Sheets
- üì± –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –∏ Slack
- üîÑ –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ (UTC+1, GEO)
- üö´ –ù–µ —Å–æ–∑–¥–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
- ‚ö° –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üöÄ –ì–û–¢–û–í –ö –î–ï–ü–õ–û–Æ –ù–ê RAILWAY!
